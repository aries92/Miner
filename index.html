<!DOCTYPE HTML>
<html>

<head>
  <meta charset="utf-8">
</head>

<style type="text/css">

	table {
		margin-top: 50px;
	}

	tr,td {
		border: 1px solid;
		padding: 10px;
	}
</style>

<body>

  <p>Miner</p>

  <input type="number" id="rows" placeholder="rows">

  <input type="number" id="cols" placeholder="cols"> <br><br>

  <button id="run-button">MAY THE FORCE BE WITH YOU!</button> 

  <table id="miner"></table>

  <script>

  	 (function() {
  		
		// private
		var runButton = document.querySelectorAll("#run-button")[0],
		    miner = document.querySelectorAll("#miner")[0];

			// Load Rows and cols	
			function loadMiner() {

				miner.innerHTML = "";

				var rowValue = parseInt(document.querySelectorAll("#rows")[0].value),
		    		colValue = parseInt(document.querySelectorAll("#cols")[0].value),
		    		quantityBombs = Math.ceil(rowValue * colValue / 2);

				for (var i = 1; i <= rowValue; i++) {
					var tr = document.createElement("TR");
					miner.appendChild(tr);
					for (var j = 1; j <= colValue; j++) {
				    	var td = document.createElement("TD");
						tr.appendChild(td);
					};
				};	

 				
				// ADD BOMBS
 				var	tdList = document.querySelectorAll("td"),
 					tdLen = document.querySelectorAll("td").length;

 					tdList = Array.prototype.slice.call(tdList);

 					bombs = tdList.sort(function(){
			        	return 0.5 - Math.random();
			        }).slice(0, quantityBombs);

			        function showBombs(argument) {
		        		bombs.forEach(function(el ,index) {
 							el.style.backgroundColor="red";
 						});
			        }

			        function win() {
			        	showBombs();
			        	alert("win");
			        	miner.innerHTML = "";
			        	// return false;
			        	
			        }

			        function fail() {
			        	showBombs();
			        	alert("fail");
			        	miner.innerHTML = "";
			        	// return false;
			        	
			        }

			        for (var j= 0; j < tdList.length; j++) {
						tdList[j].addEventListener("click", function(e) {
							bombs[e.currentTarget] ? fail() : win();
						});
			        };
			}

			runButton.addEventListener("click", loadMiner);

  	})();


  </script>

</body>

</html>